package fr.eni.aquaponeyv2;

import java.util.Random;
import java.util.Scanner;

public class AquaPoney {
// declaration des Variables		
	public static final String[] BORD_SUP = {"#","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","#"};
	public static String[] ligne1 = {"|","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","|"};
	public static String[] ligne2 = {"|","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","|"};
	public static String[] ligne3 = {"|","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","|"};
	public static final String[] BORD_INF = {"#","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","#"};
	public static String[] lignes = {"ligne1", "ligne2", "ligne3"};
	public static final String PONEY1 = "=#o";
	public static final String PONEY2 = "o#=";
	public static final String[] COUREUR = {"Huuuu DADA","Tornado   ","Pegase    "};
	public static String[] podium = {" "," "," "} ;
	public static int medaille = 0 ;
	public static int[] posi = { 1, 1, 1} ;
	public static int[] sens = { 0, 0, 0} ;
	public static int[] score = { 0, 0, 0};
	public static int limite = 26;
	public static boolean[] arrive = {false,false,false};
	public static boolean arriveGenerale = false;
	public static Random jet = new Random();
	
	public static void main(String[] args) {
		ligne1[1] = PONEY1; // initialise le premier coureur de la ligne 1
		ligne2[1] = PONEY1; // initialise le second coureur de la ligne 2
		ligne3[1] = PONEY1; // initialise le troisieme coureur de la ligne 3
		affichBassin(score[0], score[1], score[2]);	// affiche le bassin de depart 
		course(); // lance la methode de la course 
	}
	// methode de la course
	public static void course() {
		Scanner scr = new Scanner(System.in); // Declare le scanner 
		String val ; 
		// Boucle du tour des joueurs
		do {
			System.out.println("");
			System.out.println("Appuyer sur entrer pour lancer le de");
			val = scr.nextLine(); // recupere la saisie de l'utilisateur
				switch (val) {
				case "":
					for (int i = 0; i < COUREUR.length; i++) {
						if (!arrive[i]) {
							if (sens[i] == 0) { // boucle pour le trajet aller
								deplacePoney(lignes[i],"   ", posi[i]) ;
								int tmp1 = lancerDe(); // appel la fonction pour recuperer un nombre aleatoire
								posi[i] = posi[i] + tmp1 ; // modifie la position du poney en ajoutant le resultat de lancerDe
								score[i] = score[i] + tmp1 ; // ajoute le lancerDe au score
									if (posi[i] < limite) { // verifie si on a assez de place avant le fin du bassin pour se deplacer
										deplacePoney(lignes[i],PONEY1, posi[i]) ; // appel la fonction de deplacement de case 
									} else {
										int tmp2 = posi[i] - limite ; // calcul le reste de deplacement une fois arrivé au bout du bassin
										posi[i] = limite - tmp2; // recupere la position du poney
										deplacePoney(lignes[i],PONEY2, posi[i]) ; // appel la fonction de deplacement de case 
										sens[i] = 1 ;		// indique que l'on est sur le retour			
									}
								} else if (sens[i] == 1) { // boucle pour le trajet retour
									deplacePoney(lignes[i],"   ", posi[i]) ; // vide la case ou est positionné le poney
									int tmp3 = lancerDe(); // appel la fonction pour recuperer un nombre aleatoire
									posi[i] = posi[i] - tmp3 ;  // modifie la position du poney en soustrayant  le resultat de lancerDe
									score[i] = score[i] + tmp3 ; // ajoute le lancerDe au score
										if (posi[i] > 2) { // verifie la deplacement 
											deplacePoney(lignes[i],PONEY2, posi[i]) ; // positionne le poney a sa nouvelle position
										} else {
											deplacePoney(lignes[i],PONEY2, 1) ; // positionne le poney a sa nouvelle position
											score[i] = 50 ; // met le score au max 
											podium[medaille] = COUREUR[i] + " couloir" + (i+1)  ; // place le poney sur le podium 
											medaille ++ ;
											arrive[i] = true ;							
										}
								}
						}
					}
					break;
				default:
					System.out.println("Commande invalide"); // indique que le joueur a saisie tout autre chose que entrer
					break;
				}
				affichBassin(score[0], score[1], score[2]); // lance la methode affiche bassin 
				if (arrive[0] & arrive[1] & arrive[2]) { // controle que tout les poney sont arrivés
					arriveGenerale = true ; // valide l'arrivée de tout les poneys
					scr.close(); // ferme le scanner 
				}
		} while (arriveGenerale == false);
		podium(); // lance le podium
	}
	public static void deplacePoney(String ligne,String sens, int position) {
		if (ligne == "ligne1") {
			ligne1[position] = sens ;
		}
		if (ligne == "ligne2") {
			ligne2[position] = sens ;
		}
		if (ligne == "ligne3") {
			ligne3[position] = sens ;
		}
	}
	// fonction du lancer de dé
	public static int lancerDe() {
		int alea = jet.nextInt(4);
//		System.out.println(alea);
		return alea; 
	}
	// methode d'affichage du bassin
	public static void affichBassin(int info1, int info2, int info3) {
		System.out.print("          "); // place un espace avant le bassin
		for (int i = 0; i < BORD_SUP.length; i++) {
			System.out.print(BORD_SUP[i]);
		}
		System.out.println("");
		System.out.print(COUREUR[0]);
		for (int i = 0; i < ligne1.length; i++) {
			System.out.print(ligne1[i]);
		}
		System.out.print(info1 + " / 50");
		System.out.println("");
		System.out.print(COUREUR[1]);
		for (int i = 0; i < ligne2.length; i++) {
			System.out.print(ligne2[i]);
		}
		System.out.print(info2 + " / 50");
		System.out.println("");
		System.out.print(COUREUR[2]);
		for (int i = 0; i < ligne3.length; i++) {
			System.out.print(ligne3[i]);
		}
		System.out.print(info3 + " / 50");
		System.out.println("");
		System.out.print("          "); // place un espace avant le bassin
		for (int i = 0; i < BORD_INF.length; i++) {
			System.out.print(BORD_INF[i]);
		}
	}
	// methode pour afficher le bassin
	public static void podium() {
		System.out.println("");
		System.out.println("Premier   : " + podium[0]);
		System.out.println("Second    : " + podium[1]);
		System.out.println("Troisieme : " + podium[2]);
	}
}